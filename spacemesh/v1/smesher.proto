syntax = "proto3";
package spacemesh.v1;
import "google/protobuf/empty.proto";
import "spacemesh/v1/smesher_types.proto";

// Readonly basic node data
service SmesherService {

    /////// Smeshing (mining) management

    // Returns true iff node is currently smeshing
    rpc IsSmeshing(google.protobuf.Empty) returns (IsSmeshingResponse);

    // Start smeshing. Will return false if post data is incomplete or missing
    rpc StartSmeshing(google.protobuf.Empty) returns (StartSmeshingResponse);

    // Stop smeshing and optionally attempt to delete post init file(s)
    // Returns true if request is accepted by node, false if it fails
    rpc StopSmeshing(StopSmeshingRequest) returns (StopSmeshingResponse);

    // Get the current smesher id generated by the node
    rpc SmesherId(google.protobuf.Empty) returns (SmesherIdResponse);

    // Get the current coinbase
    rpc Coinbase(google.protobuf.Empty) returns (CoinbaseResponse);

    // Set the coinbase.
    // Returns true if request succeeds, false if it fails.
    rpc SetCoinbase(SetCoinbaseRequest) returns (SetCoinbaseResponse);

    // Get the current min gas for including txs in blocks by this smesher
    rpc MinGas(google.protobuf.Empty) returns (MinGasResponse);

    // Set a min gas units for including txs in blocks by this smesher
    // Returns true if request succeeds, false if it fails.
    rpc SetMinGas(SetMinGasRequest) returns (SetMinGasResponse);

    /////// Proofs of space data files management

    // Returns post data status from the node
    rpc PostStatus(google.protobuf.Empty) returns (PostStatusResponse);

    // Returns a bit field of all available setup compute engines
    rpc AvailableComputeEngines(google.protobuf.Empty) returns (AvailableComputeEnginesResponse);

    // Starts (or continues) a post init phase. Supports resuming a previously
    // started init session, as well as changing post params (e.g., post data size)
    // after initial setup.
    // Returns true if request is accepted by node, false if it fails
    rpc CreatePostData(CreatePostDataRequest) returns (CreatePostDataResponse);

    // Stop an ongoing post data init phase and optionally attempt to delete
    // the post data file(s)
    // Returns true if request is accepted by node, false if it fails
    rpc StopPostDataCreationSession(StopPostDataCreationSessionRequest) returns (StopPostDataCreationSessionResponse);

    // Returns a stream of updates to post data file(s) during the init phase
    rpc PostDataCreationProgressStream(google.protobuf.Empty) returns (stream PostDataCreationProgressStreamResponse);

}
